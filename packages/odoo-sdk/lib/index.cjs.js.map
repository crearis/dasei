{"version":3,"file":"index.cjs.js","sources":["../src/client/index.ts","../src/connector.ts","../src/index.ts"],"sourcesContent":["import axios from 'axios';\nconst axiosInstance = axios.create();\naxiosInstance.defaults.withCredentials = true;\n\nexport const client = axiosInstance;\n","import { client } from './client';\nimport { Options } from './types';\nimport * as methods from './methods/index';\nimport { MutationMetadataParams } from '../../sdk-api-client';\nimport { QueryMetadataParams } from '../../sdk-api-client';\nimport hash from 'object-hash';\n\n/**\n * Connector methods.\n */\ntype Methods = typeof methods;\n\n/**\n * Initialize the Odoo connector.\n */\nexport const odooConnector = (options: Options): Methods => {\n  let mutation = null;\n  let query = null;\n  let queryNoCache = null;\n\n  mutation = async <ApiParams, ApiResponseType>(metadata: MutationMetadataParams, params?: ApiParams): Promise<ApiResponseType> => {\n    return await client.post('mutation', [metadata, params]);\n  };\n\n  query = async <ApiParams, ApiResponseType>(metadata: QueryMetadataParams, params?: ApiParams): Promise<ApiResponseType> =>{\n    return await client.post('query', [metadata, params]);\n  };\n\n  queryNoCache = async <ApiParams, ApiResponseType>(metadata: QueryMetadataParams, params?: ApiParams): Promise<ApiResponseType> =>{\n    return await client.post('query=no-cache', [metadata, params]);\n  };\n\n  if (options.ofetch) {\n    mutation = async <ApiParams, ApiResponseType>(metadata: MutationMetadataParams, params?: ApiParams): Promise<ApiResponseType> => {\n      return options.ofetch('/api/odoo/mutation', { method: 'POST', body: [metadata, params], cache: 'no-cache', ...options.ofetchOptions });\n    };\n\n    query = async <ApiParams, ApiResponseType>(metadata: QueryMetadataParams, params?: ApiParams): Promise<ApiResponseType> =>{\n      const cacheKey = metadata.cacheKey || hash({ ...metadata, ...params });\n      return options.ofetch('/api/odoo/query', { method: 'POST', body: [metadata, params], cache: 'no-cache', key: cacheKey, ...options.ofetchOptions } as any);\n    };\n\n    queryNoCache = async <ApiParams, ApiResponseType>(metadata: QueryMetadataParams, params?: ApiParams): Promise<ApiResponseType> =>{\n      const cacheKey = metadata.cacheKey || hash({ ...metadata, ...params });\n      return options.ofetch('/api/odoo/query-no-cache', { method: 'POST', body: [metadata, params], cache: 'no-cache', key: cacheKey, ...options.ofetchOptions } as any);\n    };\n  }\n\n  client.defaults.baseURL = options.apiUrl;\n\n  return { query, mutation, queryNoCache };\n};\n","import { odooConnector } from './connector';\nimport type { Options } from './types';\nimport type { Module } from '@vue-storefront/sdk';\n\n/**\n * Boulerplate module type.\n */\nexport interface OdooModuleType extends Module {\n\n  /**\n   * The connector of the Odoo module.\n   */\n  connector: ReturnType<typeof odooConnector>;\n}\n\n/**\n * Odoo module.\n */\nexport const OdooModule = (options: Options): OdooModuleType => ({\n  connector: odooConnector({\n    apiUrl: options.apiUrl,\n    ofetch: options.ofetch\n  }),\n  utils: {},\n  subscribers: {}\n});\n\nexport { client } from './client';\n\nexport * from './types';\n"],"names":["axios","hash"],"mappings":"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"}